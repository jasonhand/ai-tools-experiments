---
export async function getStaticPaths() {
  const pages = await import.meta.glob('../content/pages/*.html', { 
    query: '?raw',
    import: 'default'
  });
  return Object.entries(pages).map(([path, importFn]) => {
    const pageName = path.split('/').pop()?.replace('.html', '') || '';
    return {
      params: { page: pageName },
      props: { importFn },
    };
  });
}

const { importFn } = Astro.props;
let rawContent = await importFn() as string;

// Fix relative paths in the HTML content
// More comprehensive path fixing for various resources
rawContent = rawContent.replace(/\.\.\/(images)/g, '/$1');
rawContent = rawContent.replace(/\.\.\/script\.js/g, '/script.js');
rawContent = rawContent.replace(/\.\.\/styles\.css/g, '/styles.css');
---

<Fragment set:html={rawContent} />